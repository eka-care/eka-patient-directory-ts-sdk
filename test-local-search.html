<!DOCTYPE html>
<html>

<head>
    <title>Local Search Test</title>
</head>

<body>
    <h1>Local Search Test</h1>
    <button onclick="runTest()">Run Local Search Test</button>
    <div id="output"></div>

    <script type="module">
        import { TrinityProfilesSDK } from './dist/index.js';

        async function runTest() {
            const output = document.getElementById('output');
            output.innerHTML = 'üöÄ Starting test...<br>';

            try {
                const sdk = new TrinityProfilesSDK({
                    baseUrl: 'https://api.eka.care',
                    accessToken: 'your-token-here',
                    workspaceId: '77088166996724',
                    enableLocalSearch: true,
                    timeout: 3000
                });

                // Test connection
                output.innerHTML += '‚úÖ Testing connection...<br>';
                await sdk.testConnection();

                // Initialize local search
                output.innerHTML += 'ÔøΩÔøΩ Initializing local search...<br>';
                await sdk.initializeLocalSearch();

                // Check local data
                const hasLocalData = await sdk.hasLocalSearchData();
                output.innerHTML += `ÔøΩÔøΩ Has local data: ${hasLocalData}<br>`;

                if (!hasLocalData) {
                    output.innerHTML += '‚¨áÔ∏è Starting sync...<br>';
                    await sdk.startLocalSync({
                        onProgress: (progress) => {
                            output.innerHTML += `üì• Synced ${progress.progress} records...<br>`;
                        }
                    });
                }

                // Test search
                const results = await sdk.search.search({ prefix: '98', limit: 5 });
                output.innerHTML += `üîç Found ${results.length} results<br>`;

                output.innerHTML += '‚ú® Test completed!<br>';
                sdk.destroy();

            } catch (error) {
                output.innerHTML += `‚ùå Error: ${error.message}<br>`;
            }
        }

        window.runTest = runTest;
    </script>
</body>

</html>